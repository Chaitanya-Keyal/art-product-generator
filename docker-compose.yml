name: art-product-generator

services:
    mongodb:
        image: mongo:8
        container_name: artgen_mongo
        restart: unless-stopped
        ports:
            - '27017:27017'
        volumes:
            - mongo_data:/data/db
        environment:
            MONGO_INITDB_DATABASE: art_product_generator

    server:
        build: ./server
        container_name: artgen_server
        restart: unless-stopped
        ports:
            - '5000:5000'
        volumes:
            - ./server:/app
            - /app/node_modules
            - ./assets:/app/assets
            - uploads_data:/app/uploads
        environment:
            - NODE_ENV=development
            - PORT=5000
            - MONGODB_URI=mongodb://mongodb:27017/art_product_generator
            - GEMINI_API_KEY=${GEMINI_API_KEY}
        depends_on:
            - mongodb

    client:
        build: ./client
        container_name: artgen_client
        restart: unless-stopped
        ports:
            - '3000:3000'
        volumes:
            - ./client:/app
            - /app/node_modules
        environment:
            - VITE_API_URL=http://localhost:5000/api
        depends_on:
            - server

volumes:
    mongo_data:
    uploads_data:
